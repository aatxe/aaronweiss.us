<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Aaron Weiss / Return of the Blog</title>
    <link href="../css/normalize.css" rel="stylesheet">
    <link href="../css/syntax.css" rel="stylesheet">
    <link href="../css/site.css" rel="stylesheet">
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="title center amethyst">
         
         
           <a href="../archive.html">
         
            <span class="emerald">&lambda;.</span> Aaron Weiss
          </a>
        </div>
      </div>
      <div class="content">
        <div class="post-info">
    <div class="post-title pull-left">Return of the Blog</div>
    <div class="post-date pull-right">May  5, 2014</div>
    <div class="clearfix"></div>
</div>
<p>I recently went through the process of moving my site from the master branch of Ghost to the stable branch. I would’ve done this earlier, but I was afraid that something would break in the process. Of course, it did. My site was offline for some time while I struggled to set up Ghost on Heroku once more, but I did it. The blog portion was missing all of the content for a longer period of time, but I’ve just now finished migrating that over. Since I had so much trouble, I’d like to document what I had to do here to get Ghost to work on Heroku.</p>
<p>Firstly, I had to set up the database to connect using <code>pg</code>. This admittedly wasn’t hard as it essentially just requires adding <code>pg</code> as a dependency in <code>package.json</code>. From there, I set up my configuration file to read all of the information from environment variables to make it easier to change without redeploying. The full configuration file can be seen <a href="https://github.com/aatxe/Ghost/blob/stable/config.js">here</a>.</p>
<p>Next, I had to add a Procfile for Heroku. After all, it needs to know what exactly it has to run. This wasn’t a difficult process though. I simply put <code>web: node index.js --production</code> as this is a production site.</p>
<p>Finally, I wanted to have the production assets generated with grunt during the deployment process. This meant a few things. I had to find a buildpack that would run a grunt task (which wasn’t hard) and then I had to add the grunt task to run. The buildpack is available on <a href="https://github.com/mbuchetics/heroku-buildpack-nodejs-grunt">GitHub</a>. The task I created was just to perform <code>prod</code>. In order to get this to run properly however, I had to move several of the dependencies from <code>devDependencies</code> to <code>dependencies</code>. This included all of the grunt dependencies and <code>matchdep</code>. However, once this was done, everything worked smoothly.</p>
<p>That being said, there’s one caveat with this whole process that tripped me up for a while. I was unable to get Heroku to properly use bower, and as such, I had to add all of the installed bower dependencies to the repository. I would like to remove this some day, and add <code>shell:bower</code> to the grunt task, but it’ll have to wait until I can get that to work. For now, including them in the repository will have to suffice.</p>
<div class="center">Comments? Email me at <a href="mailto:awe@pdgn.co">awe@pdgn.co</a>.</div>

      </div>
    </div>
  </body>
</html>
